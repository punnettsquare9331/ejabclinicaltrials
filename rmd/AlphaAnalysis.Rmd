---
title: "bayesfactorAlpha"
output: html_document
date: "2025-04-13"
---

```{r, include=FALSE}
library(httr)
library(readr)
library(dplyr)
library(ggplot2)
library(cowplot)
```

```{r}
source("../CTGJAB.R", local = knitr::knit_global())
```

```{r}
source("../rfuncs/DirichletMultinomial.R", local = knitr::knit_global())
```

```{r}
source("../dirichletMultinomialAlpha.R")
```

```{r}
# Create the main plot
main_plot <- ggplot(results_df, aes(x = alpha, y = posterior_mean)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "blue", size = 3) +
  geom_errorbar(aes(ymin = posterior_mean - posterior_se, 
                    ymax = posterior_mean + posterior_se), 
                width = 0.02, color = "blue") +
  labs(
    x = "α",
    y = "Posterior Density",
    title = "Posterior density p-value < α and eJAB > 1/3"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(hjust = 0.5),
    legend.position = "none"
  ) +
  xlim(0, 1) +
  ylim(0, 1)

# Create the log-scale inset plot for small alpha values
inset_plot <- ggplot(results_df, aes(x = alpha, y = posterior_mean)) +
  geom_line(color = "blue", size = 0.8) +
  geom_point(color = "blue", size = 2) +
  geom_errorbar(aes(ymin = posterior_mean - posterior_se, 
                    ymax = posterior_mean + posterior_se), 
                width = 0.1, color = "blue") +
  labs(x = "α", y = NULL) +
  scale_x_log10(limits = c(0.0001, 0.1), 
                breaks = c(0.0001, 0.001, 0.01, 0.1),
                labels = c("0.0001", "0.001", "0.01", "0.1")) +
  theme_minimal(base_size = 8) +
  theme(
    axis.text = element_text(size = 6),
    plot.background = element_rect(fill = "white", color = "black")
  )

# Combine with inset
alpha_plot <- ggdraw() +
  draw_plot(main_plot) +
  draw_plot(inset_plot, x = 0.5, y = 0.15, width = 0.35, height = 0.35)

# Save the plot
ggsave("../csv/posterior_probability_plot.png", alpha_plot, width = 8, height = 6, dpi = 300)

# Display the plot
print(alpha_plot)
```


